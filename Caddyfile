{
    email gabriel.rueda@metrolatam.com
}

# Configuración para todos los dominios de Publimetro
s.readmetro.com,
16.148.140.43.sslip.io,
s.elcalce.com,
s.fayerwayer.com,
s.ferplei.com,
s.metroecuador.com.ec,
s.metro.pr,
s.metroworldnews.com,
s.mwnjornal.com.br,
s.nuevamujer.com,
s.publimetro.cl,
s.publimetro.co,
s.publimetro.com.mx,
s.publinews.gt,
s.sagrosso.com {
    
    # API pasan al backend
    handle /api/* {
        reverse_proxy backend:8000
    }

    # Assets estáticos y Dashboard al frontend
    handle /_astro/* {
        reverse_proxy frontend:4321
    }
    handle /dashboard* {
        reverse_proxy frontend:4321
    }
    handle /favicon.png {
        reverse_proxy frontend:4321
    }
    handle /publimetro-logo.png {
        reverse_proxy frontend:4321
    }
    handle /@vite/* {
        reverse_proxy frontend:4321
    }
    handle /src/* {
        reverse_proxy frontend:4321
    }
    handle / {
        reverse_proxy frontend:4321
    }

    # Todo lo demás se asume que es un link corto y va al backend
    handle /* {
        reverse_proxy backend:8000
    }
}

# Acceso por IP (puerto 80)
:80 {
    # Mismo esquema que arriba
    handle /api/* {
        reverse_proxy backend:8000
    }
    handle /_astro/* {
        reverse_proxy frontend:4321
    }
    handle /dashboard* {
        reverse_proxy frontend:4321
    }
    handle /favicon.png {
        reverse_proxy frontend:4321
    }
    handle /publimetro-logo.png {
        reverse_proxy frontend:4321
    }
    handle /@vite/* {
        reverse_proxy frontend:4321
    }
    handle /src/* {
        reverse_proxy frontend:4321
    }
    handle / {
        reverse_proxy frontend:4321
    }
    handle /* {
        reverse_proxy backend:8000
    }
}
